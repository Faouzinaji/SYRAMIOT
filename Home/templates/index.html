{% extends 'base2.html' %}
{% load static %}
{% block title %}
    Dashboard
{% endblock %}
{% block content %}

  <body class="skin-blue">
    <div class="wrapper">
      


      <!-- Content Wrapper. Contains page content -->
      <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header">
          <h1>
            Dashboard Hourly 
            <button class="btn btn-primary " onclick="window.print();return false;">Print as PDF</button>

          </h1>
        </section>

        <!-- Main content -->
        <section class="content">
          <!-- Small boxes (Stat box) -->

          <div class="row">
            <div class="col-lg-3">
             
          <h3 style="font-size: 15px;">Selected Device : {{ selected.designation }}</h3>
          <h3 style="font-size: 15px;">Selected Date :  {{st}}</h3>
         
              <form action=""method="post">
                {% csrf_token %}
                
              <div class="form-group has-feedback">
                <select id="device_id" name="device_id"  class="form-control" required>
                  {% for item in all_devices %}
                  <option value="{{item.device_id}}">Device : {{ item.designation }}</option>
                  {% endfor %}
                </select>
                </div>
              <div class="form-group has-feedback">
                <small>Date:</small>
                <input class="form-control" type="date"  name="date" placeholder="Enter date" required >
             
              </div>
                <button type="submit" class="btn btn-primary ">Search</button>
                
              </form>
              
            </div>
       
            <div class="col-lg-2 col-xs-6">
              <!-- small box -->
              <div class="small-box bg-white text-black shadow" style="  border-style: solid;border-color: #d5d5d5;border-radius:5px;" >
                <div class="inner text-center">
                  <h3 style="font-size: 12px;">Units-Produced</h3>
                  <p style="font-size: 12px;">{{units_produced}}</p>
                </div>
              </div>
            </div><!-- ./col -->
            <div class="col-lg-2 col-xs-6">
              <!-- small box -->
              <div class="small-box bg-white text-black shadow" style="  border-style: solid;border-color: #d5d5d5;border-radius:5px;"  >
                <div class="inner text-center">
                  <h3 style="font-size: 12px;">Availability-Rate</h3>
                  <p style="font-size: 12px;">{{Availability_rate}}%</p>
                </div>
              </div>
            </div><!-- ./col -->
            <div class="col-lg-2 col-xs-6">
              <!-- small box -->
              <div class="small-box bg-white text-black shadow" style="  border-style: solid;border-color: #d5d5d5;border-radius:5px;" >
                <div class="inner text-center">
                  <h3 style="font-size: 12px;">Performance-Rate</h3>
                  <p style="font-size: 12px;">{{Performance_rate}}%</p>
                </div>
              </div>
            </div><!-- ./col -->
            <div class="col-lg-2 col-xs-6">
              <!-- small box -->
              <div class="small-box bg-white text-black shadow" style="  border-style: solid;border-color: #d5d5d5;border-radius:5px;"  >
                <div class="inner text-center">
                  <h3 style="font-size: 12px;">Quality-Rate</h3>
                  <p style="font-size: 12px;">{{Quality_rate}}%</p>
                </div>
              </div>
            </div><!-- ./col -->
            <div class="col-lg-2 col-xs-6">
              <!-- small box -->
              <div class="small-box bg-white text-black shadow" style="  border-style: solid;border-color: #d5d5d5;border-radius:5px;" >
                <div class="inner text-center">
                  <h3 style="font-size: 12px;">Mean</h3>
                  <p style="font-size: 12px;">{{mean}}</p>
                </div>
              </div>
            </div><!-- ./col -->
            <div class="col-lg-2 col-xs-6">
              <!-- small box -->
              <div class="small-box bg-white text-black shadow" style="  border-style: solid;border-color: #d5d5d5;border-radius:5px;"  >
                <div class="inner text-center">
                  <h3 style="font-size: 12px;">Maximun</h3>
                  <p style="font-size: 12px;">{{maximun}}</p>
                </div>
              </div>
            </div><!-- ./col -->
          
            <div class="col-lg-2 col-xs-6">
              <!-- small box -->
              <div class="small-box bg-white text-black shadow" style="  border-style: solid;border-color: #d5d5d5;border-radius:5px;"  >
                <div class="inner text-center">
                  <h3 style="font-size: 12px;">std</h3>
                  <p style="font-size: 12px;">{{std}}</p>
                </div>
              </div>
            </div><!-- ./col -->
            <div class="col-lg-2 col-xs-6">
              <!-- small box -->
              <div class="small-box bg-white text-black shadow" style="  border-style: solid;border-color: #d5d5d5;border-radius:5px;"  >
                <div class="inner text-center">
                  <h3 style="font-size: 12px;">OEE</h3>
                  <p style="font-size: 12px;">{{oee}}%</p>
                </div>
              </div>
            </div><!-- ./col -->
          </div><!-- /.row -->
          <hr>
          
          <table class="table table-borderd well well-lg" style="background: #fff;">
            <thead>
              <tr>
                <th>SL</th>
                <th>Device Password</th>
                <th>Date</th>
                <th>Time</th>
                <th>Hours</th>
                <th>Count Input</th>
                <th>Count Output</th>
                <th>State</th>
                <th>Cadence</th>
                <th>Stop</th>
                <th>MTBF</th>
                <th>MTTR</th>
              </tr>
            </thead>
            <tbody>
              {% for obj in iot_device %}
              <tr>
                <td>{% if obj.serial_no %}{{ obj.serial_no }}{% else %}-{% endif %}</td>
                <td>{% if obj.device_password %}{{ obj.device_password }}{% else %}-{% endif %}</td>
                <td>{% if obj.date %}{{ obj.date }}{% else %}-{% endif %}</td>
                <td>{% if obj.time %}{{ obj.time }}{% else %}-{% endif %}</td>
                <td>{% if obj.hours %}{{ obj.hours }}{% else %}-{% endif %}</td>
                <td>{% if obj.count_input %}{{ obj.count_input }}{% else %}-{% endif %}</td>
                <td>{% if obj.count_output %}{{ obj.count_output }}{% else %}-{% endif %}</td>
                <td>{% if obj.state %}{{ obj.state }}{% else %}-{% endif %}</td>
                <td>{% if obj.cadence %}{{ obj.cadence }}{% else %}-{% endif %}</td>
                <td>{% if obj.stop %}{{ obj.stop }}{% else %}-{% endif %}</td>
                <td>{% if obj.mtbf %}{{ obj.mtbf }}{% else %}-{% endif %}</td>
                <td>{% if obj.mttr %}{{ obj.mttr }}{% else %}-{% endif %}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          <!--Pagination-->
          <div class="container p-4">
            <div class="pagination justify-content-center">
                <span class="step-links">
                  {% if iot_device.has_previous %}
                      <a href="?page=1">&laquo; first</a>
                      <a href="?page={{ iot_device.previous_page_number }}">previous</a>
                  {% endif %}

                    <span class="current">
                        Page {{ iot_device.number }} of {{ iot_device.paginator.num_pages }}
                    </span>

                  {% if iot_device.has_next %}
                      <a href="?page={{ iot_device.next_page_number }}">next</a>
                      <a href="?page={{ iot_device.paginator.num_pages }}">last &raquo;</a>
                  {% endif %}
                </span>
                </div>
            </div>
          <!--end of Pagination-->
      
      <hr>
          <!-- Main row -->
          <div class="row">
            <!-- Left col -->
            <section class="col-lg-12 connectedSortable">
              <canvas id="myChart" style="width:100%;height: 300px;"></canvas><script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>

            </section><!-- /.Left col -->
            <section class="col-lg-12 connectedSortable">
              <canvas id="myChart2" style="width:100%;height: 300px;"></canvas><script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>

            </section><!-- /.Left col -->

            <section class="col-lg-12 connectedSortable">
              <canvas id="myChart12" style="width:100%;height: 300px;"></canvas><script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>

            </section><!-- /.Left col -->

            <section class="col-lg-12 connectedSortable mt-5">
              <div id="chartContainer" style="width: 100%; height: 360px;"></div>
           
            </section><!-- /.Left col -->
            <section class="col-lg-12 connectedSortable mt-5">
              <div id="chartContainer_rate" style="width: 100%; height: 360px;"></div>
           
            </section><!-- /.Left col -->

            <section class="col-lg-12 connectedSortable mt-5">
              <div id="chartContainer_3" style="width: 100%; height: 360px; margin-top: 10px;"></div>
            </section><!-- /.Left col -->

            <section class="col-lg-12 connectedSortable mt-5">
              <div id="chartContainer_4" style="width: 100%; height: 360px; margin-top: 10px;"></div>
            </section><!-- /.Left col -->
            
          
          </div><!-- /.row (main row) -->

        </section>
      </div><!-- /.content-wrapper -->

    </div><!-- ./wrapper -->

    <!-- jQuery 2.1.3 -->

  </body>

  <script src="{% static 'dist/js/canvasjs.min.js' %}"></script>

  <script>
    
    window.onload = function () {

      
      function toogleDataSeries(e){
        if (typeof(e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
          e.dataSeries.visible = false;
        } else{
          e.dataSeries.visible = true;
        }
        chart.render();
      }

      function toogleDataSeriesa(e){
        if (typeof(e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
          e.dataSeries.visible = false;
        } else{
          e.dataSeries.visible = true;
        }
        chart.render();
      }


      var chart = new CanvasJS.Chart("chartContainer_4", {
          animationEnabled: true,
          exportEnabled: true,
          title:{
            fontFamily: "Tahoma"
          },
          data: [{
            type: "column",
            dataPoints: {{ datapoints|safe }}
          }]
        });
        chart.render();


      var chart = new CanvasJS.Chart("chartContainer_3", {
      animationEnabled: true,
      exportEnabled: true,
      theme: "light2",
      axisY:{
        suffix: "%"
      },
      axisX: {
        labelAngle: 0,
        labelTextAlign: "center"
      },
      toolTip: {
        shared: true
      },
      data: [
      {
        type: "stackedColumn100",
        name: "breakdown",
        showInLegend: true,
        color: "#EA4335",
        toolTipContent: "{label} <br/> <span style='\"'color: {color};'\"'>{name}</span> <strong>{y} (#percent%)</strong>",
        dataPoints: {{ breakdown|safe }}
      },
      {
        type: "stackedColumn100",
        name: "off",
        showInLegend: true,
        color: "#FBBC04",
        toolTipContent: "{label} <br/> <span style='\"'color: {color};'\"'>{name}</span> <strong>{y} (#percent%)</strong>",
        dataPoints: {{ off|safe }}
      },
      {
        type: "stackedColumn100",
        name: "production",
        showInLegend: true,
        color: "#34A853",
        toolTipContent: "{label} <br/> <span style='\"'color: {color};'\"'>{name}</span> <strong>{y} (#percent%)</strong>",
        dataPoints: {{ production|safe }}
      },
      {
        type: "stackedColumn100",
        name: "stop",
        showInLegend: true,
        color: "#FF6D01",
        toolTipContent: "{label} <br/> <span style='\"'color: {color};'\"'>{name}</span> <strong>{y} (#percent%)</strong>",
        dataPoints: {{ stop_list|safe }}
      },{
        type: "stackedColumn100",
        name: "unknown",
        showInLegend: true,
        color: "#46BDC6",
        toolTipContent: "{label} <br/> <span style='\"'color: {color};'\"'>{name}</span> <strong>{y} (#percent%)</strong>",
        dataPoints: {{ unknown|safe }}
      },
    ]
    });
    chart.render();







      var chart = new CanvasJS.Chart("chartContainer", {
        animationEnabled: true,
        theme: "light2",
        exportEnabled: false,
        title:{
          text: "Units"
        },
        toolTip: {
          shared: false
        },
        axisX: {
          title: "Hours",
        },
        axisY: {
          titleFontColor: "#6D78AD",
          lineThickness: 1,
          lineColor: "#6D78AD",
          tickColor: "#6D78AD"
        },
        
        legend: {
          cursor: "pointer",
          verticalAlign: "top",
          horizontalAlign: "center",
          dockInsidePlotArea: true,
          itemclick: toogleDataSeriesa,
          fontSize: 12,
          fontColor: "dimGrey",
        },
        data: [{
          type: "spline",
          name: "Product Unit",
          showInLegend: true,
          markerSize: 0,
          dataPoints: {{ speed_data|safe }}
        },{
          type: "spline",  
          markerSize: 0,
          axisYType: "secondary",
          name: "Scraped Unit",
          showInLegend: true,
          dataPoints: {{ distance_covered_data|safe }}
        }]
      });
      chart.render();
      
      
      var chart = new CanvasJS.Chart("chartContainer_rate", {
        animationEnabled: true,
        theme: "light2",
        exportEnabled: false,
        title:{
          text: "Rate"
        },
        toolTip: {
          shared: false
        },
        axisX: {
          title: "Hours",
        },
        axisY: {
          suffix: "%",
          titleFontColor: "#6D78AD",
          lineThickness: 1,
          lineColor: "#6D78AD",
          tickColor: "#6D78AD"
        },
        
        legend: {
          cursor: "pointer",
          verticalAlign: "top",
          horizontalAlign: "center",
          dockInsidePlotArea: true,
          itemclick: toogleDataSeries,
          fontSize: 12,
          fontColor: "dimGrey",
        },
        data: [{

          type:"line",
          name: "Availability_Rate",
          showInLegend: true,
          markerSize: 0,
          dataPoints: {{ availability_list|safe }}
        },{
          type:"line",
          name: "Quality_Rate",
          showInLegend: true,
          markerSize: 0,
          dataPoints: {{ quality_list|safe }}
        },{
          type:"line",
          name: "Performance_Rate",
          showInLegend: true,
          markerSize: 0,
          dataPoints: {{ performance_rate|safe }}
        },{
          type:"line",
          name: "oee_rate",
          showInLegend: true,
          markerSize: 0,
          dataPoints: {{ oee_rate|safe }}
        },]
      });
      chart.render();

    }
    </script>  


  <script>
    var xValues = {{ su_date_label|safe }};
    
    
    new Chart("myChart", {
      type: "line",
      data: {
        labels: xValues,
        datasets: [{
          fill: false,
          lineTension: 0,
          backgroundColor: "#fc0087",
          borderColor: "#fc0087",
          data: {{ su_date_value|safe }},
          label:"Scrape-Unit"
        },
        {
          fill: false,
          lineTension: 0,
          backgroundColor: "#62929E",
          borderColor: "#62929E",
          data: {{ su_up|safe }},
           label:"Unit-Produced"
        }]
      },
      options: {
        legend: {display: false},
        title: {
                        display: true,
                        text: 'Scrape-Units-Per-Hour'
                    },
                 
                  scales: {
            xAxes: [{
                barThickness: 18,  // number (pixels) or 'flex'
                maxBarThickness:20 // number (pixels)
            }]
        }
     
      }
    });
    </script>

<script>
  var xValues = {{ oc_label|safe }};
  var yvalues = {{ oc|safe }}
  console.log(xValues);
  console.log({{ oc|safe }});
  
  
  new Chart("myChart12", {
    type: "bar",
    data: {
      labels: xValues,
      datasets: [{
        fill: false,
        lineTension: 0,
        backgroundColor: "#62929E",
        borderColor: "#62929E",
        data:yvalues
      }]
    },
    options: {
      legend: {display: false},
      title: {
                      display: true,
                      text: 'State Occurance'
                  },
                  scales: {
            xAxes: [{
                barThickness: 18,  // number (pixels) or 'flex'
                maxBarThickness:20 // number (pixels)
            }]
        }
   
    }
  });
  </script>
<script>
 var xValues = {{ su_date_label|safe }};

new Chart("myChart2", {
  type: "line",
  data: {
    labels: xValues,
    datasets: [
      
      {
      fill: false,
      lineTension: 0,
      backgroundColor: "#5c5959",
          borderColor: "#5c5959",
      data: {{ ar_value|safe }},
      label:"Availability-Rate"
    
    }, 
      {
      fill: false,
      lineTension: 0,
      backgroundColor: "#62929E",
          borderColor: "#62929E",
      data: {{ pr_value|safe }},
      label:"Performance-Rate"
    },
    {
      fill: false,
      lineTension: 0,
      backgroundColor: "#fc0087",
          borderColor: "#fc0087",
      data: {{ qr_value|safe }},
      label:"Quality-Rate"
    }, {
      fill: false,
      lineTension: 0,
      backgroundColor: "#fa0c00",
          borderColor: "#fa0c00",
      data: {{ oee_value|safe }},
      label:"OEE-Rate"
    }
  
  ]
  },
   
  options: {
    legend: {display: true},
        title: {
                        display: true,
                        text: 'Availability-Performance-Quality-OEE-rate-Per-Hour'
                    }
  }
});
  </script>

{% endblock %}

